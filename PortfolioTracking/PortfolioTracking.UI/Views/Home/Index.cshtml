@using PortfolioTracking.Data;
@model PortfolioTracking.Data.ViewModel.DataVM
@{
    ViewData["Title"] = "Home Page";
}


<div class="text-center">
    <h1>PORTFOLIO</h1>
</div>
<div class="mb-3">
    <table class="table table-success table-striped" name="portfolioTable" id="portfolioTable">
        <tr>
            <th>
                Ticker
            </th>
            <th>
                OperationName
            </th>
            <th>
                Qty
            </th>
            <th>
                Price
            </th>
            <th>
                Cost
            </th>

            <th>
                TradeDate
            </th>
        </tr>



        @foreach (var item in Model.PortfolioList)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Ticker)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.OperationName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Qty)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Price)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Cost)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TradeDate)
                </td>

            </tr>
        }

    </table>
</div>
<div class="text-center">
    <button type="button" class="btn btn-sm btn-secondary" onclick="PrintPortFolio()">Print Portfolio</button>
</div>

<hr />
<div class="text-center">
    <h1>P&L REPORT</h1>
    <p style="color:darkred">Please Fetch Current Market Data to See the Record.</p>
</div>

<hr />
<div class="mb-3">
    <table class="table table-primary table-striped" name="plreportTable" id="plreportTable">
        <tr>
            <th>
                Ticker
            </th>
            <th>
                TradeDate
            </th>
            <th>
                Qty
            </th>
            <th>
                Price
            </th>
            <th>
                Cost
            </th>

            <th>
                CurrentClose
            </th>
            <th>
                MarketValue
            </th>
            <th>
                PrevClose
            </th>
            <th>
                DailyPL
            </th>
            <th>
                InceptionPL
            </th>
        </tr>



        @foreach (var item in Model.PLReportList)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Ticker)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TradeDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Qty)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Price)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Cost)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CurrentClose)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.MarketValue)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.PrevClose)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DailyPL)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.InceptionPL)
                </td>

            </tr>
        }

    </table>
</div>
<div class="text-center">
    <button type="button" class="btn btn-sm btn-secondary" onclick="PrintPLReport()">Print P&L Report</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.1.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>


    function PrintPortFolio() {
        const table = document.getElementById('portfolioTable');

        html2pdf().set({ html2canvas: { scale: 4 } }).from(table).save('portfolio.pdf');
    };

    function PrintPLReport() {
        const table = document.getElementById('plreportTable');

        html2pdf().set({ html2canvas: { scale: 4 } }).from(table).save('pnlreport.pdf');
    };


</script>





